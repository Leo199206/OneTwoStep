System.register("chunks:///main.js",["cc"],(function(){"use strict";var t,i,e,n,a,r,s,o,l,u,h;return{setters:[function(c){t=c.cclegacy,i=c._decorator,e=c.Component,n=c.tween,a=c.Vec3,r=c.Label,s=c.director,o=c.AudioClip,l=c.AudioSource,u=c.Prefab,h=c.instantiate}],execute:function(){function c(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}function p(t,i,e,n){e&&Object.defineProperty(t,i,{enumerable:e.enumerable,configurable:e.configurable,writable:e.writable,value:e.initializer?e.initializer.call(n):void 0})}function d(t,i,e,n,a){var r={};return Object.keys(n).forEach((function(t){r[t]=n[t]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=e.slice().reverse().reduce((function(e,n){return n(t,i,e)||e}),r),a&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(a):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(t,i,r),r=null),r}var b;t._RF.push({},"9b5b7hd8KxMtq8emLKmDU4J","Block",void 0);const{ccclass:m,property:y}=i;let f=m("Block")(b=class extends e{constructor(...t){super(...t),c(this,"fallHeight",500),c(this,"fallDuration",.3)}start(){}init(t,i,e,n){this.fallDuration=t,this.fallHeight=i,this.scheduleOnce((()=>{n(this)}),e)}getSinkingTween(){return n(this.node).by(this.fallDuration,{position:new a(0,-this.fallHeight,0)})}})||b;var g,v,w,D,k;t._RF.pop(),t._RF.push({},"b5903aStvxAYIiS4hyyTSuR","OverPanel",void 0);const{ccclass:S,property:j}=i;let z=(g=S("OverPanel"),v=j({type:r}),g((k=d((D=class extends e{constructor(...t){super(...t),p(this,"score",k,this)}start(){this.node.active=!1}show(t){this.score.string=""+t,this.node.active=!0}again(){this.node.active=!1,s.loadScene("game")}backMenu(){this.node.active=!1,s.loadScene("menu")}}).prototype,"score",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=D))||w);var A;t._RF.pop(),t._RF.push({},"c7f19gWindFxInVEPD2TPqr","Menu",void 0);const{ccclass:P,property:B}=i;P("Menu")(A=class extends e{start(){}onBtnPlay(){s.loadScene("game")}});var O,J,H,x,F,T,L,R,_,G,N;t._RF.pop(),t._RF.push({},"f6424Aj3Y1EHZFQeVOjiHkJ","Player",void 0);const{ccclass:X,property:E}=i;let C=(O=X("Player"),J=E({type:o}),H=E({type:o}),x=E({type:o}),F=E({type:l}),O((R=d((L=class extends e{constructor(...t){super(...t),c(this,"stepDistance",0),c(this,"jumpHeight",0),c(this,"jumpDuration",0),c(this,"canJump",!1),c(this,"index",0),c(this,"curPosition",null),c(this,"fallDuration",0),c(this,"fallHeight",0),p(this,"oneStepAudio",R,this),p(this,"twoStepAudio",_,this),p(this,"dieAudio",G,this),p(this,"audio",N,this)}start(){}init(t,i,e,n,a){this.stepDistance=t,this.jumpHeight=i,this.jumpDuration=e,this.canJump=!0,this.fallDuration=n,this.fallHeight=a,this.curPosition=this.node.getPosition()}jump(t,i){this.canJump=!1,this.index+=t;let e=t*this.stepDistance,a=t*this.jumpHeight,r=this.getJumpUpTween(e,a),s=this.getJumpDownTween(e);n(this.node).sequence(r,s).call((()=>{this.canJump=!0,i()})).start(),this.playJumpAudio(t)}playJumpAudio(t){var i;if(1==t)null===(i=this.audio)||void 0===i||i.playOneShot(this.oneStepAudio,1);else if(2==t){var e;null===(e=this.audio)||void 0===e||e.playOneShot(this.twoStepAudio,1)}}playDieAudio(){var t;null===(t=this.audio)||void 0===t||t.playOneShot(this.dieAudio,1)}getJumpUpTween(t,i){let e=new a(t/2,i,0);return e.add(this.curPosition),n(this.node).to(this.jumpDuration,{position:e},{easing:"sineIn"})}getJumpDownTween(t){var i;return null===(i=this.curPosition)||void 0===i||i.add3f(t,0,0),n(this.node).to(this.jumpDuration,{position:this.curPosition},{easing:"sineOut"})}startDelayOverGameAnimation(){this.scheduleOnce((()=>{this.getSinkingTween().start()}),2*this.jumpDuration)}getSinkingTween(){return n(this.node).by(this.fallDuration,{position:new a(0,-this.fallHeight,0)},{easing:"smooth"})}}).prototype,"oneStepAudio",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=d(L.prototype,"twoStepAudio",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=d(L.prototype,"dieAudio",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=d(L.prototype,"audio",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=L))||T);var M,I,V,q,U,K,Y,Z,Q,W,$,tt,it,et,nt,at,rt,st,ot,lt,ut,ht,ct,pt;t._RF.pop(),t._RF.push({},"d3f8ePl8jtEwZXVf/x3XETH","Stage",void 0);const{ccclass:dt,property:bt}=i;let mt=(M=dt("Stage"),I=bt({type:C}),V=bt({type:u}),q=bt({type:Number}),U=bt({type:Number}),K=bt({type:Number}),Y=bt({type:Number}),Z=bt({type:Number}),Q=bt({type:Number}),W=bt({type:Number}),$=bt({type:Number}),tt=bt({type:Number}),M((nt=d((et=class extends e{constructor(...t){super(...t),p(this,"player",nt,this),p(this,"blockPrefab",at,this),c(this,"game",null),p(this,"stepDistance",rt,this),p(this,"jumpHeight",st,this),p(this,"jumpDuration",ot,this),p(this,"fallHeight",lt,this),p(this,"fallDuration",ut,this),p(this,"initStayDuration",ht,this),p(this,"minStayDuration",ct,this),p(this,"speed",pt,this),c(this,"stayDuration",0),c(this,"blockList",[]),c(this,"lastBlock",!0),c(this,"lastBlockX",0)}init(t){var i;this.game=t,this.lastBlockX=-430,this.stayDuration=this.initStayDuration,null===(i=this.player)||void 0===i||i.init(this.stepDistance,this.jumpHeight,this.jumpDuration,this.fallDuration,this.fallHeight),this.addBlock(new a(this.lastBlockX,-280));for(var e=0;e<10;e++)this.randomAddBlock()}randomAddBlock(){this.lastBlockX=this.lastBlockX+this.stepDistance,!this.lastBlock||Math.random()>.5?this.addBlock(new a(this.lastBlockX,-280)):this.addBlank()}addBlock(t){var i=h(this.blockPrefab);null!=i&&(i.position=t,this.node.addChild(i),this.blockList.push(i.getComponent(f)),this.lastBlock=!0)}moveStage(t){n(this.node).by(this.jumpDuration,{position:new a(-this.stepDistance*t,0)}).start();for(var i=0;i<t;i++)this.randomAddBlock()}addBlank(){this.blockList.push(null),this.lastBlock=!1}playerJump(t){console.info("playerJump step="+t),this.player&&this.player.canJump&&(this.moveStage(t),this.player.jump(t,(()=>{this.jumpEnd(t)})))}jumpEnd(t){let i=this.player.index;if(!this.hasBlock(i)){var e;null===(e=this.player)||void 0===e||e.getSinkingTween().call((()=>{var t,i;null===(t=this.game)||void 0===t||t.overGame(),null===(i=this.player)||void 0===i||i.playDieAudio()})).start()}else{var n;let e=this.blockList[i];null==e||e.init(this.fallDuration,this.fallHeight,this.stayDuration,this.callOverGame(i)),null===(n=this.game)||void 0===n||n.addScore(1==t?1:3)}i%10==0&&this.changeSpeed()}callOverGame(t){return i=>{var e;if(t===(null===(e=this.player)||void 0===e?void 0:e.index)){var n;console.info("callOverGame");let t=this.player.getSinkingTween(),e=i.getSinkingTween();null===(n=this.player)||void 0===n||n.playDieAudio(),e.start(),t.call((()=>{var t;null===(t=this.game)||void 0===t||t.overGame()})).start()}}}hasBlock(t){return this.blockList[t]instanceof f}changeSpeed(){this.stayDuration-=this.speed,this.stayDuration<=this.minStayDuration&&(this.stayDuration=this.minStayDuration)}start(){}}).prototype,"player",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),at=d(et.prototype,"blockPrefab",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rt=d(et.prototype,"stepDistance",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),st=d(et.prototype,"jumpHeight",[U,K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),ot=d(et.prototype,"jumpDuration",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),lt=d(et.prototype,"fallHeight",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 500}}),ut=d(et.prototype,"fallDuration",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),ht=d(et.prototype,"initStayDuration",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),ct=d(et.prototype,"minStayDuration",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),pt=d(et.prototype,"speed",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),it=et))||it);var yt,ft,gt,vt,wt,Dt,kt,St,jt;t._RF.pop(),t._RF.push({},"fa024yf7cpJhJIAeJFodsAg","Game",void 0);const{ccclass:zt,property:At}=i;yt=zt("Game"),ft=At(mt),gt=At({type:r}),vt=At({type:z}),yt((kt=d((Dt=class extends e{constructor(...t){super(...t),p(this,"stage",kt,this),p(this,"scoreLabel",St,this),p(this,"overPanel",jt,this),c(this,"score",0),c(this,"isOver",!1)}start(){this.startGame()}startGame(){this.score=0,this.scoreLabel&&(this.scoreLabel.string=this.score+""),this.stage&&this.stage.init(this)}overGame(){var t;console.info("game over"),this.isOver=!0,null===(t=this.overPanel)||void 0===t||t.show(this.score)}addScore(t){this.score+=t,this.scoreLabel&&(this.scoreLabel.string=this.score+"")}returnMenu(){s.loadScene("menu")}onClickStepOne(){var t;this.isOver||null===(t=this.stage)||void 0===t||t.playerJump(1)}onClickStepTwo(){var t;this.isOver||null===(t=this.stage)||void 0===t||t.playerJump(2)}}).prototype,"stage",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),St=d(Dt.prototype,"scoreLabel",[gt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),jt=d(Dt.prototype,"overPanel",[vt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),wt=Dt));t._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///main.js'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});
//# sourceMappingURL=index.js.map